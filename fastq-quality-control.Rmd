---
title: "FASTQ Quality Control"
author: "Sam Buckberry"
date: "23/10/2021"
output: html_document
---



```{r}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("Rfastp")
```

```{r}
library(Rfastp)
library(stringr)
library(magrittr)
```


```{r}
read1 <- "1001-Effector_CD4pos_T-S_sorted_chr22_R1.fastq.gz"
read2 <- "1001-Effector_CD4pos_T-S_sorted_chr22_R2.fastq.gz"

out_prefix <- str_replace(string = pe_read1,
                          pattern = "_R1.fastq.gz",
                          replacement = "_filtered")

fastp_json_report <- rfastp(read1 = read1, read2 = read2, 
                            outputFastq = out_prefix,
                            adapterTrimming = TRUE,
                            cutLowQualTail = TRUE,
                            thread = 1)
```



